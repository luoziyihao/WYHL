# 职责

对外支付行为 对接支付渠道, 发起账务

对内支付行为 发起帐务

# 简单流程

- 对外支付

发起对外支付 -> 对被调用方通知支付消息 -> 发起帐务 -> 被通知支付帐务成功

- 对内支付
 
发起对内支付 -> 发起帐务 -> 被通知支付帐务成功

- 收款录入

发起对内支付 -> 发起帐务 -> 被通知支付帐务成功



# 实体


- 支付实体
 


- 用户购买理财产品订单


订单金额 优惠抵扣 实付金额


- 理财收益订单

订单金额 实收金额


- 用户充值订单

订单金额 手续费 实收金额


- 提现


订单金额


# 行为(接口)


- 对外支付

用户充值

用户提现

用户使用银行卡购买理财产品

公司给商户打款

- 对内

使用余额购买理财产品
商品返利
卖出

- 收款录入

公司在商户那里购买的理财产品回款后, 信息录入到内部系统


# 异常行为

支付状态异常 在对账阶段能够发现

重发 同支付实体 相同支付行为在毫秒级时间内相互提交 ; 可以使用 redis 做并发锁控制
